SELECT DISTINCT
/* Information on PTMS Z09 Class and its Content by Material  
 * Used Tables/Views:
 * MV_P2R_Z09_DATEN_CONTENT
 *  */
Z09Data.Matnr AS "MATNR", 
Z09Data.MATNR8 AS "MATNR8",
max(CASE WHEN (Z09Data.ATINN='0000028219') THEN Z09DATa."CONTENT_TXT_AGG" ELSE NULL END) AS "Contract_manufacturer_codetype",
max(CASE WHEN (Z09Data.ATINN='0000028220') THEN Z09DATa."CONTENT_TXT_AGG" ELSE NULL END) AS "Contract_manufacturer_code",
max(CASE WHEN (Z09Data.ATINN='0000028204') THEN Z09DATa."CONTENT_TXT_AGG" ELSE NULL END) AS "Responsible_for_specification",
max(CASE WHEN (Z09Data.ATINN='0000028223') THEN Z09DATa."CONTENT_TXT_AGG" ELSE NULL END) AS "Contract_manufacturer_material",
max(CASE WHEN (Z09Data.ATINN='0000028210') THEN Z09DATa."CONTENT_TXT_AGG" ELSE NULL END) AS "Layout_approved",
max(CASE WHEN (Z09Data.ATINN='0000028207') THEN Z09DATa."CONTENT_TXT_AGG" ELSE NULL END) AS "Usage_Prefix",
max(CASE WHEN (Z09Data.ATINN='0000028386') THEN Z09DATa."CONTENT_TXT_AGG" ELSE NULL END) AS "Number_of_pages",
max(CASE WHEN (Z09Data.ATINN='0000028228') THEN Z09DATa."CONTENT_TXT_AGG" ELSE NULL END) AS "ACF_Flag",
max(CASE WHEN (Z09Data.ATINN='0000028216') THEN Z09DATa."CONTENT_TXT_AGG" ELSE NULL END) AS "Visible_Markings",
max(CASE WHEN (Z09Data.ATINN='0000028215') THEN Z09DATa."CONTENT_TXT_AGG" ELSE NULL END) AS "Code",
max(CASE WHEN (Z09Data.ATINN='0000028211') THEN Z09DATa."CONTENT_TXT_AGG" ELSE NULL END) AS "Colors",
max(CASE WHEN (Z09Data.ATINN='0000028212') THEN Z09DATa."CONTENT_TXT_AGG" ELSE NULL END) AS "Number_colors_front",
max(CASE WHEN (Z09Data.ATINN='0000028222') THEN Z09DATa."CONTENT_TXT_AGG" ELSE NULL END) AS "Contract_manufacturer",
max(CASE WHEN (Z09Data.ATINN='0000028206') THEN Z09DATa."CONTENT_TXT_AGG" ELSE NULL END) AS "Article_codetype",
max(CASE WHEN (Z09Data.ATINN='0000028205') THEN Z09DATa."CONTENT_TXT_AGG" ELSE NULL END) AS "Article_code",
max(CASE WHEN (Z09Data.ATINN='0000028224') THEN Z09DATa."CONTENT_TXT_AGG" ELSE NULL END) AS "Contract_man_visible_markings",
max(CASE WHEN (Z09Data.ATINN='0000028221') THEN Z09DATa."CONTENT_TXT_AGG" ELSE NULL END) AS "Contract_manufacturer_mt_index",
max(CASE WHEN (Z09Data.ATINN='0000028214') THEN Z09DATa."CONTENT_TXT_AGG" ELSE NULL END) AS "Component_scrab_key",
max(CASE WHEN (Z09Data.ATINN='0000028225') THEN Z09DATa."CONTENT_TXT_AGG" ELSE NULL END) AS "Remarks",
max(CASE WHEN (Z09Data.ATINN='0000028208') THEN Z09DATa."CONTENT_TXT_AGG" ELSE NULL END) AS "Printed",
max(CASE WHEN (Z09Data.ATINN='0000028213') THEN Z09DATa."CONTENT_TXT_AGG" ELSE NULL END) AS "Number_colors_back",
max(CASE WHEN (Z09Data.ATINN='0000028227') THEN Z09DATa."CONTENT_TXT_AGG" ELSE NULL END) AS "Print_characteristics",
max(CASE WHEN (Z09Data.ATINN='0000028209') THEN Z09DATa."CONTENT_TXT_AGG" ELSE NULL END) AS "Braille_text",
--max(CASE WHEN (Z09Data.ATINN='0000028226') THEN Z09DATa."CONTENT_TXT_AGG" ELSE NULL END) AS "Number of pages_2", --not needed anymore / not fillde
max(CASE WHEN (Z09Data_CHAR.ATINN='0000028227') AND Z09Data_CHAR.CONTENT='1' THEN 'Yes' ELSE 'No' END) AS "PrintChar_Braille",
max(CASE WHEN (Z09Data_CHAR.ATINN='0000028227') AND Z09Data_CHAR.CONTENT='2' THEN 'Yes' ELSE 'No' END) AS "PrintChar_FoilStamp",
max(CASE WHEN (Z09Data_CHAR.ATINN='0000028227') AND Z09Data_CHAR.CONTENT='3' THEN 'Yes' ELSE 'No' END) AS "PrintChar_Varnish",
max(CASE WHEN (Z09Data_CHAR.ATINN='0000028227') AND Z09Data_CHAR.CONTENT='4' THEN 'Yes' ELSE 'No' END) AS "PrintChar_Cryptoglyph",
max(CASE WHEN (Z09Data_CHAR.ATINN='0000028227') AND Z09Data_CHAR.CONTENT='5' THEN 'Yes' ELSE 'No' END) AS "PrintChar_PseudoCryptoglyph",
max(CASE WHEN (Z09Data_CHAR.ATINN='0000028227') AND Z09Data_CHAR.CONTENT='6' THEN 'Yes' ELSE 'No' END) AS "PrintChar_Peak",
max(CASE WHEN (Z09Data_CHAR.ATINN='0000028227') AND Z09Data_CHAR.CONTENT='7' THEN 'Yes' ELSE 'No' END) AS "PrintChar_Embossing",
max(CASE WHEN (Z09Data_CHAR.ATINN='0000028227') AND Z09Data_CHAR.CONTENT='8' THEN 'Yes' ELSE 'No' END) AS "PrintChar_CoinReactiveInk",
max(CASE WHEN (Z09Data_CHAR.ATINN='0000028227') AND Z09Data_CHAR.CONTENT='9' THEN 'Yes' ELSE 'No' END) AS "PrintChar_IriodinLacquer",
max(CASE WHEN (Z09Data_CHAR.ATINN='0000028227') AND Z09Data_CHAR.CONTENT='10' THEN 'Yes' ELSE 'No' END) AS "PrintChar_UVLacquer",
max(CASE WHEN (Z09Data_CHAR.ATINN='0000028227') AND Z09Data_CHAR.CONTENT='11' THEN 'Yes' ELSE 'No' END) AS "PrintChar_PerlmuttLacquer",
max(CASE WHEN (Z09Data_CHAR.ATINN='0000028227') AND Z09Data_CHAR.CONTENT='12' THEN 'Yes' ELSE 'No' END) AS "PrintChar_RichPaleGold",
max(CASE WHEN (Z09Data_CHAR.ATINN='0000028227') AND Z09Data_CHAR.CONTENT='13' THEN 'Yes' ELSE 'No' END) AS "PrintChar_SilverHotFoil",
max(CASE WHEN (Z09Data_CHAR.ATINN='0000028227') AND Z09Data_CHAR.CONTENT='14' THEN 'Yes' ELSE 'No' END) AS "PrintChar_Unvarnish",
max(CASE WHEN (Z09Data_CHAR.ATINN='0000028227') AND Z09Data_CHAR.CONTENT='15' THEN 'Yes' ELSE 'No' END) AS "PrintChar_SecurityVarish",
max(CASE WHEN (Z09Data_CHAR.ATINN='0000028227') AND Z09Data_CHAR.CONTENT='16' THEN 'Yes' ELSE 'No' END) AS "PrintChar_MattVarnish",
max(CASE WHEN (Z09Data_CHAR.ATINN='0000028227') AND Z09Data_CHAR.CONTENT='17' THEN 'Yes' ELSE 'No' END) AS "PrintChar_CodingBySupplier",
max(CASE WHEN (Z09Data_CHAR.ATINN='0000028227') AND Z09Data_CHAR.CONTENT='18' THEN 'Yes' ELSE 'No' END) AS "PrintChar_BKLogo",
max(CASE WHEN (Z09Data_CHAR.ATINN='0000028227') AND Z09Data_CHAR.CONTENT='19' THEN 'Yes' ELSE 'No' END) AS "PrintChar_S_DR"
FROM 
	--Subselect to aggregate the "CONTENT_TXT" based on the ATINN per Material Number
	(SELECT
	MATNR,
	MATNR8,
	String_agg(CONTENT_TXT,', ' ORDER BY CONTENT_TXT asc) AS "CONTENT_TXT_AGG",
	ATINN
	FROM
 	   SXOKEDSX.MV_P2R_Z09_DATA_CONTENT
	GROUP BY MATNR,MATNR8,ATINN) Z09DATA
	LEFT JOIN 
	--Get Print Characteristics by value (e.g. 1 = Braille)
		(SELECT
		MATNR,
		ATINN,
		CONTENT
		FROM
	 	   SXOKEDSX.MV_P2R_Z09_DATA_CONTENT
		GROUP BY MATNR,ATINN,CONTENT) Z09DATA_CHAR ON Z09DATA.MATNR = Z09Data_CHAR.MATNR
GROUP BY Z09Data.MATNR, Z09Data.MATNR8